# 11559. Puyo Puyo

[링크](https://www.acmicpc.net/problem/11559)

| 난이도 | 정답률(\_%) |
| :----: | :---------: |
| Gold V |   34.587    |

## 설계

### 시간복잡도

시간제한은 1초, 뿌요뿌요판의 크기는 12, 6 이다.

전체 판을 순회하며 떠질 뿌요가 존재하는지 BFS로 판단한다.

이후 뿌요가 터지는 데 최대 전체 판의 크기만큼 터질 수 있다.

```cpp
12 * 6 // 전체를 순회
12 * 6 // BFS로 터질 뿌요가 존재하는지 확인
12 * 6 // 뿌요를 터뜨리는데 들어가는 시간

12^3 * 6^3 = 373,248‬
```

따라서 총 시간복잡도는 373,248‬ 정도이며 이는 제한시간 1초 내에 풀 수 있다.

### 하나의 사이클

하나의 싸이클은 다음과 같은 순서이다.

1. while문으로 전체를 감쌈
2. 전체를 순회하며 터질 뿌요가 존재하는지 확인
3. 터질 뿌요가 존재할 경우 터뜨릴 목록에 저장
4. 터뜨릴 목록이 비어있는 경우
   - while문 탈출
5. 터뜨릴 목록이 존재하는 경우
   - 목록을 순회하며 뿌요를 터뜨림
   - 밑으로 떨어뜨리는 동작 수행
   - count 1 증가

### BFS

터질 뿌요가 존재하는지 순회와, 뿌요를 터뜨리는 동작은 BFS를 이용해 판단한다.

```cpp
// bfs로 전체를 순환하는 함수
void bfs(int y, int x){
  queue<axis> q;
  q.push({y, x});
  visited[y][x] = true;

  while (!q.empty()) {
    if (count >= 4) {
      break;
    }

    axis cur = q.front();
    q.pop();

    for (axis d : dir) {
      axis next = cur;
      next.y += d.y;
      next.x += d.x;

      if (next.y < 0 || next.y >= 12 || next.x < 0 || next.x >= 6) {
        continue;
      }

      if (!visited[next.y][next.x]) {
        q.push(next);
        count += 1;
        visited[next.y][next.x] = true;
      }
    }
  }
}
```

여기서 visited 배열은 뿌요를 터뜨릴 때도 사용하므로 전역변수로 선언할 수 있다.

다음과 같은 경우 check를 수행할 필요가 없다.

- 현재 좌표가 빈칸인경우
- 현재 좌표가 곧 터질 뿌요일 경우

### 아래로 떨어뜨리는 함수

가장 맨 아래칸에서 위로 순회하며 다음 규칙을 따른다.

1. 현재 칸이 터질 뿌요일 경우
   - 현재 칸 위로부터 한칸씩 아래로 당김
   - 맨 위칸은 빈 공간임을 채워넣음
2. 현재 칸이 일반 뿌요인 경우
   - 윗칸으로 이동
3. 가장 윗 칸까지 끝난 경우 반복문 탈출

여기서 현재 뿌요가 터질 뿌요인 경우 index를 증가시키면 안된다.

```cpp
index = 2 // 맨 아래
1
0
0 // index
```

이 경우 맨 아래를 터뜨리고 이동한 경우

```cpp
index = 2 // 맨아래
0
1
0 // index
```

다음과 같이 되며, 현재 index의 뿌요가 터뜨릴 뿌요이기 때문이다.

만약 index를 이동하는 경우 터질 뿌요가 연속으로 있을 때 오류가 발생한다.

```cpp
void pull() {
  for (int x = 0; x < 6; x++) {
    int y = 11;

    while (y >= 0) {
      if (map[y][x] == -1) {
        for (int j = y; j >= 1; j -= 1) {
          map[j][x] = map[j - 1][x];
        }
        map[0][x] = 0;
      } else {
        y -= 1;
      }
    }
  }
}
```

## 정리

| 내 코드 (ms) | 빠른 코드 (ms) |
| :----------: | :------------: |
|      0       |       0        |

## 고생한 점
